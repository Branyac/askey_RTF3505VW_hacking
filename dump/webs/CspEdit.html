<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
         <link rel="stylesheet" href='colors.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var iidStack = '';

function frmLoad() {
   var names = '<%ejGet(paramBuf)%>'.split('/');
   if (names.length == 13) {
      iidStack = names[0];
      with (document.forms[0]) {
         VendorClassId.value = htmlDecode(names[1]);
         MinIpAddr.value = names[2];
         MaxIpAddr.value = names[3];
         SubnetMask.value = names[4];
         Router.value = names[5];
         var dns = names[6].split(',');
         DnsServer1.value = (dns.length>0)?dns[0]:'';
         DnsServer2.value = (dns.length>1)?dns[1]:'';
         Option240.value = htmlDecode(names[7]);
         Option241.value = htmlDecode(names[8]);
         Option242.value = htmlDecode(names[9]);
         Option243.value = htmlDecode(names[10]);
         Option244.value = htmlDecode(names[11]);
         Option245.value = htmlDecode(names[12]);

         selectFocus(VendorClassId);
      }
   }
}

function htmlDecode(s) {
   var div = document.createElement('div');
   div.innerHTML = s;
   return div.innerText;
}

function selectFocus(inputText) {
   inputText.focus();
   inputText.setSelectionRange(0, inputText.value.length);
}

function btnApply() {
   var loc = 'dhcpdconditionallease.cmd?action=edit';
   with ( document.forms[0] ) {
      if (""==VendorClassId.value) {
         alert('VendorClassId "' + VendorClassId.value + '" is empty.');
         selectFocus(VendorClassId);
         return;
      }
      else if (isXSS(VendorClassId.value)) {
         alert('!!Scripting Cross-site (Persistent) - Persistent XSS on Vendor Class Id');
         selectFocus(VendorClassId);
         return;
      }
      else if (isValidIpAddress(MinIpAddr.value) == false) {
         alert('MinIpAddr "' + MinIpAddr.value + '" is invalid IP address.');
         selectFocus(MinIpAddr);
         return;
      }
      else if (isValidIpAddress(MaxIpAddr.value) == false) {
         alert('MaxIpAddr "' + MaxIpAddr.value + '" is invalid IP address.');
         selectFocus(MaxIpAddr);
         return;
      }
      else if (isValidSubnetMask(SubnetMask.value) == false) {
         alert('SubnetMask "' + SubnetMask.value + '" is invalid IP address.');
         selectFocus(SubnetMask);
         return;
      }
      else if (isValidIpAddress(Router.value) == false) {
         alert('Router "' + Router.value + '" is invalid IP address.');
         selectFocus(Router);
         return;
      }
      else if (DnsServer1.value!= "" && isValidIpAddress(DnsServer1.value) == false) {
         alert('DnsServer1 "' + DnsServer1.value + '" is invalid IP address.');
         selectFocus(DnsServer1);
         return;
      }
      else if (DnsServer2.value!= "" && isValidIpAddress(DnsServer2.value) == false) {
         alert('DnsServer2 "' + DnsServer2.value + '" is invalid IP address.');
         selectFocus(DnsServer2);
         return;
      }
      else {
         loc += '&iid=' + iidStack;
         loc += '&VendorClassId=' + VendorClassId.value;
         loc += '&MinIpAddr=' + MinIpAddr.value;
         loc += '&MaxIpAddr=' + MaxIpAddr.value;
         loc += '&Router=' + Router.value;
         loc += '&SubnetMask=' + SubnetMask.value;
         loc += '&DnsServer1=' + DnsServer1.value;
         loc += '&DnsServer2=' + DnsServer2.value;
         loc += '&Option240=' + Option240.value;
         loc += '&Option241=' + Option241.value;
         loc += '&Option242=' + Option242.value;
         loc += '&Option243=' + Option243.value;
         loc += '&Option244=' + Option244.value;
         loc += '&Option245=' + Option245.value;
         loc += '&sessionKey=<%ejGetOther(sessionKey)%>';
         var code = 'location="' + loc + '"';
         eval(code);
      }
   }
}

// done hiding -->
</script>
   </head>
   <body onLoad='frmLoad()'>
      <blockquote>
         <form>
            <b>Edit DHCP Conditional Lease </b><br>
            <br>
            Modify the information of conditional pool then click "Apply/Save".<br>
            <br>
            <br>
            <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td >Vendor Class Id:</td>
                  <td><input type='text' name='VendorClassId'></td>
               </tr>
               <tr>
                  <td>Min IP Address:</td>
                  <td><input type='text' name='MinIpAddr'> </td>
               </tr>
               <tr>
                  <td>Max IP Address:</td>
                  <td><input type='text' name='MaxIpAddr'></td>
               </tr>
               <tr>
                  <td>Subnet Mask:</td>
                  <td><input type='text' name='SubnetMask'></td>
               </tr>
               <tr>
                  <td>Router:</td>
                  <td><input type='text' name='Router'></td>
               </tr>
               <tr>
                  <td>DNS servers1:</td>
                  <td><input type='text' name='DnsServer1'></td>
               </tr>
               <tr>
                  <td>DNS servers2:</td>
                  <td><input type='text' name='DnsServer2'></td>
               </tr>
               <tr>
                  <td>Option 240:</td>
                  <td><input type='text' name='Option240'></td>
               </tr>
               <tr>
                  <td>Option 241:</td>
                  <td><input type='text' name='Option241'></td>
               </tr>
               <tr>
                  <td>Option 242:</td>
                  <td><input type='text' name='Option242'></td>
               </tr>
               <tr>
                  <td>Option 243:</td>
                  <td><input type='text' name='Option243'></td>
               </tr>
               <tr>
                  <td>Option 244:</td>
                  <td><input type='text' name='Option244'></td>
               </tr>
               <tr>
                  <td>Option 245:</td>
                  <td><input type='text' name='Option245'></td>
               </tr>

            </table>
            <br>
            <br>
            <center>
               <input type='button' onClick='btnApply()' value='Apply/Save'>
            </center>
         </form>
      </blockquote>
   </body>
</html>

